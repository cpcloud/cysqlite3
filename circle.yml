machine:
  python:
    version: 3.5.2
  pre:
    - sudo apt-get install --only-upgrade sqlite3
    - sudo apt-get install libllvm-3.8-ocaml-dev libllvm3.8 llvm-3.8 llvm-3.8-dev llvm-3.8-runtime
    - sudo apt-get remove --purge libllvm-3.4-ocaml-dev libllvm3.4 llvm-3.4 llvm-3.4-dev llvm-3.4-runtime
    - sudo apt-get autoremove

  environment:
    LLVM_CONFIG: llvm-config-3.8

dependencies:
  override:
    - pip install -U pip
    - pip install -r requirements.txt
    - pip install pytest

test:
  override:
    - py.test slumba --tb=short --junitxml="$CIRCLE_TEST_REPORTS/junit.xml"
